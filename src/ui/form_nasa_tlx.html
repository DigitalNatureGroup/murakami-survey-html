<h2>NASA-TLX 作業負荷評価</h2>

<p>以下の7つの項目について、作業中の負荷の程度を評価してください。各スライダーは左が「小さい/低い/良い」、右が「大きい/高い/悪い」を示します。</p>

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 20px 0; font-size: 0.9em; color: #666;">
  <strong>参考:</strong> 芳賀・水上（1996）「日本語版 NASA-TLX によるメンタルワークロード測定」『産業・組織心理学研究』10(2) 準拠
</div>

<form id="nasaTlxForm">
  <!-- 精神的要求 -->
  <div class="form-item">
    <label for="mental">
      精神的要求 (Mental Demand)
      <span class="desc">
        どの程度の知的・知覚的活動（考える、決める、計算する、記憶する、見るなど）を必要としましたか。
        課題はやさしかったですか難しかったですか。単純でしたか複雑でしたか、正確さが求められましたか、大ざっぱでよかったですか。
      </span>
    </label>
    <input type="range" id="mental" name="mental" min="0" max="100" value="50" required>
    <div class="anchors">
      <span>小さい</span>
      <span>大きい</span>
    </div>
  </div>

  <!-- 身体的要求 -->
  <div class="form-item">
    <label for="physical">
      身体的要求 (Physical Demand)
      <span class="desc">
        どの程度の身体的活動（押す、引く、回す、制御する、動き回るなど）を必要としましたか。
        作業はラクでしたかキツかったですか、ゆっくりできましたかキビキビやらなければなりませんでしたか、休み休みできましたか働きづめでしたか。
      </span>
    </label>
    <input type="range" id="physical" name="physical" min="0" max="100" value="50" required>
    <div class="anchors">
      <span>小さい</span>
      <span>大きい</span>
    </div>
  </div>

  <!-- 時間的要求 -->
  <div class="form-item">
    <label for="temporal">
      時間的要求 (Temporal Demand)
      <span class="desc">
        仕事のペースや課題が発生する頻度のために感じる時間的切迫感はどの程度でしたか。
        ペースはゆっくりとして余裕があるものでしたか、それとも速くて余裕のないものでしたか。
      </span>
    </label>
    <input type="range" id="temporal" name="temporal" min="0" max="100" value="50" required>
    <div class="anchors">
      <span>短い</span>
      <span>長い</span>
    </div>
  </div>

  <!-- 作業成績 -->
  <div class="form-item">
    <label for="performance">
      作業成績 (Performance)
      <span class="desc">
        作業指示者（またはあなた自身）によって設定された課題の目標をどの程度達成できたと思いますか。
        目標の達成に関して自分の作業成績にどの程度満足していますか。
      </span>
    </label>
    <input type="range" id="performance" name="performance" min="0" max="100" value="50" required>
    <div class="anchors">
      <span>良い</span>
      <span>悪い</span>
    </div>
  </div>

  <!-- 努力 -->
  <div class="form-item">
    <label for="effort">
      努力 (Effort)
      <span class="desc">
        作業成績のレベルを達成・維持するために、精神的・身体的にどの程度いっしょうけんめいに作業しなければなりませんでしたか。
      </span>
    </label>
    <input type="range" id="effort" name="effort" min="0" max="100" value="50" required>
    <div class="anchors">
      <span>少ない</span>
      <span>多い</span>
    </div>
  </div>

  <!-- 欲求不満 -->
  <div class="form-item">
    <label for="frustration">
      欲求不満 (Frustration)
      <span class="desc">
        作業中に、不安感、落胆、いらいら、ストレス、悩みをどの程度感じましたか。
        あるいは逆に、安心感、満足感、充足感、楽しさ、リラックスをどの程度感じましたか。
      </span>
    </label>
    <input type="range" id="frustration" name="frustration" min="0" max="100" value="50" required>
    <div class="anchors">
      <span>低い</span>
      <span>高い</span>
    </div>
  </div>

  <!-- 全体的負荷 -->
  <div class="form-item">
    <label for="overall">
      全体的負荷 (Overall Workload)
      <span class="desc">
        さまざまな負荷要因、負荷原因。部分部分の課題内容を総合すると、全体としてどの程度の作業負担を感じましたか。
      </span>
    </label>
    <input type="range" id="overall" name="overall" min="0" max="100" value="50" required>
    <div class="anchors">
      <span>低い</span>
      <span>高い</span>
    </div>
  </div>
</form>

<!-- 回答確認エリア -->
<div id="answerSummary" style="display: none; background: #e8f5e8; padding: 15px; border-radius: 8px; margin: 20px 0;">
  <h3 style="margin-top: 0; color: #2e7d32;">📊 回答確認</h3>
  <div id="summaryContent"></div>
</div>

<script>
  // 回答データを収集する関数（レイアウトから呼び出される）
  window.collectAnswers = function() {
    const form = document.getElementById('nasaTlxForm');
    const formData = new FormData(form);
    const answers = {};
    
    // 各フィールドの値を取得
    for (const [key, value] of formData) {
      answers[key] = parseInt(value);
    }
    
    // 回答の妥当性チェック
    const requiredFields = ['mental', 'physical', 'temporal', 'performance', 'effort', 'frustration', 'overall'];
    for (const field of requiredFields) {
      if (!answers[field] && answers[field] !== 0) {
        throw new Error(`${field} の回答が不足しています`);
      }
    }
    
    return answers;
  };
  
  // ページ読み込み時の処理
  window.onPageLoad = function() {
    console.log('NASA-TLX アンケートが読み込まれました');
    
    // スライダーの値変更時に回答確認を表示
    const sliders = document.querySelectorAll('input[type="range"]');
    sliders.forEach(slider => {
      slider.addEventListener('input', updateAnswerSummary);
    });
    
    // 初期表示
    updateAnswerSummary();
  };
  
  // 回答確認の更新
  function updateAnswerSummary() {
    const summaryDiv = document.getElementById('answerSummary');
    const contentDiv = document.getElementById('summaryContent');
    
    if (!summaryDiv || !contentDiv) return;
    
    const answers = {};
    const labels = {
      mental: '精神的要求',
      physical: '身体的要求',
      temporal: '時間的要求',
      performance: '作業成績',
      effort: '努力',
      frustration: '欲求不満',
      overall: '全体的負荷'
    };
    
    // 各スライダーの値を取得
    for (const [key, label] of Object.entries(labels)) {
      const slider = document.getElementById(key);
      if (slider) {
        answers[key] = parseInt(slider.value);
      }
    }
    
    // 回答確認の表示
    let summaryHtml = '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">';
    for (const [key, value] of Object.entries(answers)) {
      summaryHtml += `
        <div style="background: white; padding: 8px; border-radius: 4px;">
          <strong>${labels[key]}:</strong> ${value}
        </div>
      `;
    }
    summaryHtml += '</div>';
    
    contentDiv.innerHTML = summaryHtml;
    summaryDiv.style.display = 'block';
  }
</script>

<style>
  /* NASA-TLX 専用スタイル */
  .form-item {
    margin: 30px 0;
    padding: 20px;
    border: 1px solid #e9ecef;
    border-radius: 8px;
    background: white;
  }
  
  .form-item label {
    font-weight: bold;
    display: block;
    margin-bottom: 8px;
    color: #333;
  }
  
  .form-item .desc {
    font-weight: normal;
    font-size: 0.9em;
    color: #666;
    line-height: 1.5;
    display: block;
    margin-top: 5px;
    font-style: italic;
  }
  
  .form-item input[type="range"] {
    width: 100%;
    max-width: 500px;
    margin: 10px 0;
  }
  
  .form-item .anchors {
    display: flex;
    justify-content: space-between;
    font-size: 0.85em;
    margin-top: 5px;
    color: #666;
    font-weight: 500;
  }
  
  /* スライダーのカスタマイズ */
  input[type="range"] {
    -webkit-appearance: none;
    appearance: none;
    height: 8px;
    border-radius: 4px;
    background: #ddd;
    outline: none;
  }
  
  input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: #667eea;
    cursor: pointer;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  }
  
  input[type="range"]::-moz-range-thumb {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: #667eea;
    cursor: pointer;
    border: none;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  }
</style>
